<?php
/**
 * Plugin Name: System rezerwacji lotów tandemowych
 * Description: Plugin do rezerwacji lotów tandemowych w WooCommerce.
 * Version: 2.0
 * Author: Autogenerated
 */

if (!defined('ABSPATH')) {exit;}

define('SRL_PLUGIN_DIR', plugin_dir_path(__FILE__));
define('SRL_PLUGIN_URL', plugin_dir_url(__FILE__));

require_once SRL_PLUGIN_DIR . 'includes/class-srl-bootstrap.php';

register_activation_hook(__FILE__, function() {
    SRL_Database_Setup::getInstance()->activatePlugin();
});

register_deactivation_hook(__FILE__, function() {
    wp_clear_scheduled_hook('srl_sprawdz_przeterminowane_loty');
});

SRL_Bootstrap::getInstance()->init();


// do wywalenia

add_action( 'woocommerce_thankyou', 'custom_change_order_status', 20, 1 );
function custom_change_order_status( $order_id ) {
    if ( ! $order_id ) {
        return;
    }

    $order = wc_get_order( $order_id );

    if ( ! $order ) {
        return;
    }

    $current_status = $order->get_status();

    // Sprawdź, czy status to "on-hold" lub "pending"
    if ( in_array( $current_status, array( 'on-hold', 'pending' ) ) ) {
        $order->update_status( 'processing', __( 'Automatyczna zmiana statusu zamówienia.', 'custom-order-status-updater' ) );
    }
}